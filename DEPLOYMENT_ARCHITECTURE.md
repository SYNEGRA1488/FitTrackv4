# FiTTrack Global Deployment - Визуальная схема

## 🏗️ Архитектура после запуска

```
┌─────────────────────────────────────────────────────────────┐
│                     ПОЛЬЗОВАТЕЛИ (ИНТЕРНЕТ)                 │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ↓
┌─────────────────────────────────────────────────────────────┐
│                    DNS СИСТЕМА (мир)                        │
│  Ваш регистратор (GoDaddy, Namecheap и т.д.)              │
│  NS: ns1.vercel-dns.com, ns2.vercel-dns.com и т.д.        │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ↓
┌─────────────────────────────────────────────────────────────┐
│               ГЛОБАЛЬНЫЙ CDN (Vercel Edge)                  │
│  Быстрая доставка контента из ближайшего сервера           │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ↓
┌─────────────────────────────────────────────────────────────┐
│                   VERCEL ОБЛАКО (США)                       │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  Next.js приложение (index.html, page.tsx и т.д.)  │   │
│  │  • Авто-генерируется статический контент           │   │
│  │  • API роуты (/api/auth, /api/workouts и т.д.)     │   │
│  │  • PWA, Service Worker                             │   │
│  │  • HTTPS/SSL автоматически                         │   │
│  └────────────────────────┬────────────────────────────┘   │
│                           │                                 │
│                           ↓                                 │
│  ┌──────────────────────────────────────────────────────┐  │
│  │        Переменные окружения (Vercel Env)            │  │
│  │  • DATABASE_URL                                     │  │
│  │  • JWT_SECRET                                       │  │
│  │  • OPENAI_API_KEY                                   │  │
│  │  • NEXT_PUBLIC_APP_URL = https://fit-track.eu      │  │
│  │  • NODE_ENV = production                            │  │
│  └──────────────────────────────────────────────────────┘  │
└────────────────────────┬────────────────────────────────────┘
                         │
                         ├──────────────────────────┐
                         │                          │
                         ↓                          ↓
        ┌─────────────────────────────┐   ┌──────────────────────┐
        │   PostgreSQL БД (Vercel)    │   │  OpenAI API          │
        │  • Пользователи              │   │  • AI ассистент      │
        │  • Тренировки                │   │  • Тренировочные     │
        │  • Планы                     │   │    планы             │
        │  • Подписки                  │   │                      │
        │  Бесплатно: 256 MB           │   │  (платный)           │
        └─────────────────────────────┘   └──────────────────────┘
```

---

## 📊 Процесс развертывания

```
ЭТАП 1: ПОДГОТОВКА (вы сейчас здесь)
┌─────────────────────────────────────────┐
│ 1. Выбрать хостинг (Vercel)             │ ← СЕЙЧАС
│ 2. Выбрать БД (Vercel Postgres)         │ ← СЕЙЧАС
│ 3. Обновить .env.production             │ ← СЕЙЧАС
│ 4. Загрузить код в Git                  │ ← СЕЙЧАС
└──────────────┬──────────────────────────┘
               │ (30-40 минут)
               ↓

ЭТАП 2: РАЗВЕРТЫВАНИЕ
┌─────────────────────────────────────────┐
│ 1. Развернуть на Vercel                 │ ← СКРИПТ deploy.bat
│ 2. Добавить домен fit-track.eu          │ ← СКРИПТ
│ 3. Загрузить переменные окружения       │ ← СКРИПТ
└──────────────┬──────────────────────────┘
               │ (20-30 минут)
               ↓

ЭТАП 3: DNS КОНФИГУРАЦИЯ
┌─────────────────────────────────────────┐
│ 1. Обновить NS или CNAME записи         │ ← ВРУЧНУЮ
│    в регистраторе домена                │
│ 2. Проверить пропагацию DNS             │ ← nslookup
└──────────────┬──────────────────────────┘
               │ (24-48 часов)
               ↓

ЭТАП 4: LIVE! 🎉
┌─────────────────────────────────────────┐
│ Сайт доступен на https://fit-track.eu  │
│ ✓ SSL сертификат                        │
│ ✓ Глобальный CDN                        │
│ ✓ База данных работает                  │
│ ✓ API функционирует                     │
└─────────────────────────────────────────┘
```

---

## 🔄 Обновления после запуска

```
БЫ ПИШЕТЕ КОД
    │
    ↓
git add .
git commit -m "Feature: новая функция"
git push origin main
    │
    ↓
GITHUB АВТОМАТИЧЕСКИ УВЕДОМЛЯЕТ VERCEL
    │
    ↓
VERCEL АВТОМАТИЧЕСКИ:
├─ Скачивает новый код
├─ Устанавливает зависимости (npm install)
├─ Собирает проект (npm run build)
├─ Проверяет ошибки
├─ Развертывает на production
└─ Создает HTTPS с SSL
    │
    ↓
ПОЛЬЗОВАТЕЛИ ВИДЯТ ОБНОВЛЕНИЯ БЕЗ ПЕРЕЗАГРУЗКИ
```

---

## 🌍 Где находятся данные

```
ВЫ (локальная машина)                    ИНТЕРНЕТ (Production)
─────────────────────                    ──────────────────

.env.local                               .env.production (на Vercel)
├─ localhost:3000                        ├─ https://fit-track.eu
├─ dev.db (SQLite)                       ├─ Vercel Postgres
└─ dev-ключи                             └─ production-ключи
                                         (защищены)

НИКОГДА НЕ КОММИТЬТЕ:
- .env файлы
- Пароли
- API ключи
- Secret ключи
```

---

## 📱 Как работает PWA

```
ПОЛЬЗОВАТЕЛЬ ОТКРЫВАЕТ https://fit-track.eu
              │
              ↓
БРАУЗЕР СКАЧИВАЕТ:
├─ HTML (страница)
├─ CSS (стили)
├─ JavaScript (функции)
├─ Service Worker (offline функции)
├─ manifest.json (инфо приложения)
└─ Иконки и ассеты
              │
              ↓
МОЖНО УСТАНОВИТЬ КАК ПРИЛОЖЕНИЕ
├─ На телефон (iOS/Android)
├─ На рабочий стол (Windows/Mac/Linux)
└─ Использовать без интернета (частично)
```

---

## 🔐 Как защищены данные

```
ПОЛЬЗОВАТЕЛЬ ВХОДИТ
      │
      ↓
ОТПРАВЛЯЕТ: email + пароль
      │
      ├─ ❌ НЕ СОХРАНЯЕТСЯ В БРАУЗЕРЕ
      │
      ├─ ✓ ШИФРУЕТСЯ (HTTPS/SSL)
      │
      ├─ ✓ ОТПРАВЛЯЕТСЯ НА VERCEL
      │
      ├─ ✓ ПРОВЕРЯЕТСЯ В API
      │
      ├─ ✓ ХЭШИРУЕТСЯ В БД (bcrypt)
      │
      └─ ВОЗВРАЩАЕТСЯ JWT TOKEN
                 │
                 ✓ СОХРАНЯЕТСЯ В БРАУЗЕРЕ
                 ✓ ИСПОЛЬЗУЕТСЯ ДЛЯ ВСЕХ ЗАПРОСОВ
                 ✓ ЗАЩИЩЕН HttpOnly COOKIE (опционально)
```

---

## 💰 Стоимость структура (Free tier)

```
VERCEL HOSTING
├─ Builds: ∞ (неограниченно)
├─ Serverless Functions: ∞ (неограниченно)
├─ Bandwidth: 100 GB/месяц ← БЕСПЛАТНО
├─ Deployment: ∞ (неограниченно)
└─ SSL: ✓ (автоматически)
         ────────────────────
         СТОИМОСТЬ: БЕСПЛАТНО ✓

VERCEL POSTGRES
├─ Storage: 256 MB ← БЕСПЛАТНО
├─ Connections: Unlimited
├─ Backups: Automated
└─ Scaling: Automatic
         ────────────────────
         СТОИМОСТЬ: БЕСПЛАТНО ✓

OPENAI API (используется в приложении)
├─ ChatGPT 4: $0.03 / 1K tokens (input)
├─ ChatGPT 4: $0.06 / 1K tokens (output)
└─ Зависит от использования
         ────────────────────
         СТОИМОСТЬ: ПЛАТНО (но контролируемо)

ДОМЕН fit-track.eu
├─ Уже куплен (один раз)
├─ Обновление: ~$10-15/год
└─ Без дополнительной платы на Vercel
         ────────────────────
         СТОИМОСТЬ: ~$1-2/месяц
```

---

## 🚀 Масштабирование в будущем

```
СЕЙЧАС (Free tier)          БУДУЩЕЕ (Если вырастет)
─────────────────           ────────────────────────

100 пользователей           10,000 пользователей
├─ Vercel Free              ├─ Vercel Pro ($20/месяц)
├─ Vercel Postgres 256MB     ├─ Vercel Postgres Pro
├─ Ограничено 100GB traffic  ├─ AWS RDS PostgreSQL
└─ Достаточно               ├─ 1 TB+ storage
                            ├─ 1,000 GB+ traffic
                            └─ Auto-scaling

                            1,000,000 пользователей
                            ├─ Dedicated servers
                            ├─ Cloud database clusters
                            ├─ CDN optimization
                            ├─ Rate limiting
                            ├─ Load balancing
                            └─ Custom infrastructure
```

---

## 📈 Как отслеживать производительность

```
ИНСТРУМЕНТЫ КОТОРЫЕ ИСПОЛЬЗОВАТЬ:

1. VERCEL DASHBOARD
   https://vercel.com/dashboard
   ├─ Real-time трафик
   ├─ Ошибки и логи
   ├─ Build статус
   └─ Deployment история

2. GOOGLE ANALYTICS
   https://analytics.google.com
   ├─ Посетители
   ├─ Страницы
   ├─ Устройства
   └─ Поведение

3. LIGHTHOUSE
   https://pagespeed.web.dev
   ├─ Performance score
   ├─ SEO score
   ├─ Accessibility
   └─ Best Practices

4. SENTRY (опционально)
   https://sentry.io
   ├─ Ошибки JavaScript
   ├─ Stack traces
   ├─ Уведомления
   └─ Аналитика ошибок
```

---

## 🎯 Финальная схема развертывания

```
                    ┌─────────────────────┐
                    │   ВАШ КОД НА GITHUB │
                    │  (git push origin)  │
                    └──────────┬──────────┘
                               │
                               ↓
                    ┌─────────────────────┐
                    │  VERCEL АВТОМАТИЧНО │
                    │  ├─ Pull code       │
                    │  ├─ npm install     │
                    │  ├─ npm run build   │
                    │  └─ Deploy          │
                    └──────────┬──────────┘
                               │
                ┌──────────────┼──────────────┐
                │              │              │
                ↓              ↓              ↓
        ┌──────────────┐ ┌──────────────┐ ┌──────────────┐
        │   EDGE NODE  │ │  EDGE NODE   │ │  EDGE NODE   │
        │  (Europe)    │ │  (America)   │ │   (Asia)     │
        │ https://..   │ │ https://..   │ │  https://..  │
        └──────┬───────┘ └──────┬───────┘ └──────┬───────┘
               │                 │                │
               └─────────────────┼────────────────┘
                                 │
                    ┌────────────────────────┐
                    │  ВАШЕЙ БАЗЕ ДАННЫХ    │
                    │  (Vercel Postgres)     │
                    │  postgresql://...      │
                    └────────────────────────┘

РЕЗУЛЬТАТ:
├─ ✓ Мгновенная скорость (Edge CDN)
├─ ✓ Низкий Latency (географически близко)
├─ ✓ Автоматические обновления
├─ ✓ Бесплатный SSL/HTTPS
├─ ✓ Защита от DDoS (Vercel)
└─ ✓ 99.99% uptime
```

---

## 🎓 Легенда терминов

| Термин | Значение | Пример |
|--------|----------|--------|
| **DNS** | Система конвертации имён в IP | fit-track.eu → 123.45.67.89 |
| **HTTPS** | Защищённый протокол | https://fit-track.eu |
| **SSL** | Сертификат безопасности | 🔒 зелёный замок |
| **CDN** | Сеть серверов по миру | Быстрая доставка контента |
| **Edge** | Серверы близко к пользователям | Vercel Edge Networks |
| **JWT** | Токен аутентификации | Для проверки кто вы |
| **PWA** | Веб-приложение как мобильное | Установка + offline режим |
| **Vercel** | Платформа для развертывания | Наш хостинг для Next.js |
| **Postgres** | Реляционная база данных | БД для всех данных |
| **API** | Интерфейс для запросов | /api/auth, /api/workouts |
| **ENV** | Переменные окружения | Ключи и конфиги (не в коде) |

---

Готово! Начните с `QUICK_START_GLOBAL.md` → `GLOBAL_DEPLOYMENT_STATUS.md` → потом `deploy.bat` (Windows) или `deploy.sh` (Linux/Mac)

🚀 Удачи!
